<!DOCTYPE HTML>
<html lang="pt">
<head>
<!-- Generated by javadoc (21) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: com.rpg.combate, class: FlechaMagica">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">// src/com/rpg/combate/FlechaMagica.java</span>
<span class="source-line-no">002</span><span id="line-2">package com.rpg.combate;</span>
<span class="source-line-no">003</span><span id="line-3"></span>
<span class="source-line-no">004</span><span id="line-4">import com.rpg.exceptions.RecursoInsuficienteException;</span>
<span class="source-line-no">005</span><span id="line-5">import jakarta.xml.bind.annotation.XmlRootElement; // ADICIONADO: Import para a anotação JAXB</span>
<span class="source-line-no">006</span><span id="line-6"></span>
<span class="source-line-no">007</span><span id="line-7">// O import de 'com.rpg.personagens.herois.Elfo' foi removido,</span>
<span class="source-line-no">008</span><span id="line-8">// pois a classe não dependerá mais diretamente do tipo concreto Elfo.</span>
<span class="source-line-no">009</span><span id="line-9"></span>
<span class="source-line-no">010</span><span id="line-10">/**</span>
<span class="source-line-no">011</span><span id="line-11"> * Representa uma habilidade mágica de ataque, a Flecha Mágica. Causa um dano base</span>
<span class="source-line-no">012</span><span id="line-12"> * elevado que pode ser aumentado ou reduzido com base no atributo de sorte do usuário.</span>
<span class="source-line-no">013</span><span id="line-13"> * Esta habilidade consome mana do combatente que a executa.</span>
<span class="source-line-no">014</span><span id="line-14"> * A implementação utiliza apenas os métodos disponíveis na interface {@link Combatente},</span>
<span class="source-line-no">015</span><span id="line-15"> * promovendo a reutilização e reduzindo o acoplamento, conforme os princípios de agregação.</span>
<span class="source-line-no">016</span><span id="line-16"> */</span>
<span class="source-line-no">017</span><span id="line-17">@XmlRootElement(name = "flechaMagica") // ADICIONADO: Define o elemento raiz para esta classe em XML</span>
<span class="source-line-no">018</span><span id="line-18">public class FlechaMagica implements AcaoDeCombate {</span>
<span class="source-line-no">019</span><span id="line-19"></span>
<span class="source-line-no">020</span><span id="line-20">    private static final int CUSTO_MANA = 20; // Flecha Mágica custa 20 de mana</span>
<span class="source-line-no">021</span><span id="line-21"></span>
<span class="source-line-no">022</span><span id="line-22">    /**</span>
<span class="source-line-no">023</span><span id="line-23">     * ADICIONADO: Construtor sem argumentos exigido pelo JAXB para desserialização.</span>
<span class="source-line-no">024</span><span id="line-24">     */</span>
<span class="source-line-no">025</span><span id="line-25">    public FlechaMagica() {} // Construtor padrão</span>
<span class="source-line-no">026</span><span id="line-26"></span>
<span class="source-line-no">027</span><span id="line-27">    /**</span>
<span class="source-line-no">028</span><span id="line-28">     * Executa a Flecha Mágica, causando dano ao alvo.</span>
<span class="source-line-no">029</span><span id="line-29">     * Calcula o dano com base na força do usuário, na arma equipada e no atributo de sorte.</span>
<span class="source-line-no">030</span><span id="line-30">     * Consome mana do usuário e lança uma exceção se a mana for insuficiente.</span>
<span class="source-line-no">031</span><span id="line-31">     *</span>
<span class="source-line-no">032</span><span id="line-32">     * @param usuario O combatente que está executando a habilidade (espera-se que seja um usuário com mana e sorte, como o Elfo).</span>
<span class="source-line-no">033</span><span id="line-33">     * @param alvo O combatente que é o alvo da habilidade.</span>
<span class="source-line-no">034</span><span id="line-34">     * @throws RecursoInsuficienteException Se o combatente não tiver mana suficiente para usar a habilidade.</span>
<span class="source-line-no">035</span><span id="line-35">     */</span>
<span class="source-line-no">036</span><span id="line-36">    @Override</span>
<span class="source-line-no">037</span><span id="line-37">    public void executar(Combatente usuario, Combatente alvo) throws RecursoInsuficienteException {</span>
<span class="source-line-no">038</span><span id="line-38">        // A lógica agora opera diretamente com a interface Combatente.</span>
<span class="source-line-no">039</span><span id="line-39">        // Assume-se que a interface Combatente (e consequentemente a classe Personagem</span>
<span class="source-line-no">040</span><span id="line-40">        // e suas subclasses) expõe os getters e setters necessários como getMana(),</span>
<span class="source-line-no">041</span><span id="line-41">        // usarMana(), getArma(), getForca(), getNome(), getSorte() e receberDano().</span>
<span class="source-line-no">042</span><span id="line-42"></span>
<span class="source-line-no">043</span><span id="line-43">        // --- LÓGICA DE MANA ---</span>
<span class="source-line-no">044</span><span id="line-44">        // Verifica se o usuário tem mana suficiente para usar a habilidade.</span>
<span class="source-line-no">045</span><span id="line-45">        if (usuario.getMana() &lt; CUSTO_MANA) {</span>
<span class="source-line-no">046</span><span id="line-46">            throw new RecursoInsuficienteException("Recursos insuficientes para usar a habilidade.");</span>
<span class="source-line-no">047</span><span id="line-47">        }</span>
<span class="source-line-no">048</span><span id="line-48">        usuario.usarMana(CUSTO_MANA); // Consome a mana do usuário.</span>
<span class="source-line-no">049</span><span id="line-49">        // --- FIM DA LÓGICA DE MANA ---</span>
<span class="source-line-no">050</span><span id="line-50">        </span>
<span class="source-line-no">051</span><span id="line-51">        // Calcula o dano especial: dano da arma equipada + força do usuário + um bônus base.</span>
<span class="source-line-no">052</span><span id="line-52">        int danoEspecial = (usuario.getArma() != null ? usuario.getArma().getDano() : 0) + usuario.getForca() + 20;</span>
<span class="source-line-no">053</span><span id="line-53"></span>
<span class="source-line-no">054</span><span id="line-54">        // Adiciona bônus de dano se a sorte do usuário for alta.</span>
<span class="source-line-no">055</span><span id="line-55">        // JAXB: Math.random() não é serializável, mas o resultado é temporário, então não há problema aqui.</span>
<span class="source-line-no">056</span><span id="line-56">        if (usuario.getSorte() &gt; 0.4) {</span>
<span class="source-line-no">057</span><span id="line-57">            danoEspecial += 15;</span>
<span class="source-line-no">058</span><span id="line-58">            System.out.println("A sorte favorece! Flecha Mágica causa dano extra!");</span>
<span class="source-line-no">059</span><span id="line-59">        } </span>
<span class="source-line-no">060</span><span id="line-60">        </span>
<span class="source-line-no">061</span><span id="line-61">        System.out.println(usuario.getNome() + " usou Flecha Mágica com " + (usuario.getArma() != null ? usuario.getArma().getNomeCompleto() : "punhos") + "!");</span>
<span class="source-line-no">062</span><span id="line-62">        </span>
<span class="source-line-no">063</span><span id="line-63">        alvo.receberDano(danoEspecial); // O alvo recebe o dano especial.</span>
<span class="source-line-no">064</span><span id="line-64">        System.out.println("A habilidade causou " + danoEspecial + " de dano especial!");</span>
<span class="source-line-no">065</span><span id="line-65">    }</span>
<span class="source-line-no">066</span><span id="line-66">}</span>




























































</pre>
</div>
</main>
</body>
</html>
